# 0: Zero
## Desc
* / only
* extremally thin (w/o selinux NM; 833M, 231 rpms)
* += dnf mc rpmreaper net-tools chrony
* net: 192.168.0.1, server.lan
* updated to 2016-03-02
## TODO
* yum -y install epel-release
* yum install dnf mc rpmreaper net-tools chrony
* dnf update
* systemctl enable chronyd.service; systemctl start chronyd.service
* /etc/sysconfig/selinux: disabled; /etc/fstab: /dev/vda
* yum clean all; dnf clean all; dd if=/dev/zero of=/bigfile bs=1M; rm -f /bigfile

# 1: LDAP
## Desc:
Nothing
### Non-LDAP
* Caches: ln -s /var/cahce/{dnf,yum}
* NFS (nfs-utils?)
* ?diskless
* ?cups
* ?sane

### LDAP
* LDAP:
(dc=lan)
 * 1. install openldap:
```
dnf install\
openldap-servers\
openldap-clients\
nss-pam-ldapd\
authconfig\
bind-sdb-chroot\
[bind-dyndb-ldap]\
dhcpd\
smbldap-tools\
samba-dc\
dovecot\
postfix
```
 * 2. prepare:
```
cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG
chown ldap. /var/lib/ldap/DB_CONFIG
systemctl start slapd
systemctl enable slapd
# set LDAP admin password:
slappasswd -s secred
# import basic schemas
# set LDAM mgr password:
# mk initial tree (mgr, root)
```
* PAM:
 * create LDAP entries:
```
ldapadd -x -D "cn=odmin" -w tratatata -h localhost -p 389 -f Users.ldif
mk_users.sh
```
 * configure pam:
```
authconfig --enableldap --enableldapauth --disablenis --enablecache --ldapserver=localhost --ldapbasedn=dc=lan --updateall
```
 * /etc/openldap/ldap.conf:
```
tls_cacertdir /etc/openldap/cacerts
uri ldap://localhost/
base dc=ldap
# added
#host 127.0.0.1
scope sub
pam_filter objectclass=posixAccount
pam_login_attribute uid
pam_password exop
nss_base_passwd ou=Users,dc=lan?one
nss_base_shadow ou=Users,dc=lan?one
nss_base_group  ou=Groups,dc=lan?one
nss_initgroups_ignoreusers root,ldap
ssl no
pam_password md5
```
 * Enable services:
```
systemctl enable nscd && systemctl start nscd
systemctl enable nslcd && systemctl start nslcd
init 6
```
 * create homes:
```
mkdir -p /mnt/shares/home
for i in `getent passwd | gawk -F'[/:]' '{print $1}' | grep ^user`; do mkdir /mnt/shares/home/$i; chown $i:users /mnt/shares/home/$i; done
```
* DNS
* DHCP
* SAMBA
* IMAP/POP3
* SMTP
* Proxy
* FTP (pureftpd)
* HTTP
* WebDAV
* XMPP
* NFS
### 386

### Addons
* CUPS
* SANE
* DiskLess
* eGW etc

# 2: upgrade
* export old LDAP data (users, hosts (dhcp)
